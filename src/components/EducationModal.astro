---
// Enhanced Education Modal with Professional Impact sections
interface Props {
  modalId: string;
  degree: string;
  university: string;
  location: string;
  years: string;
  imageUrl?: string;
  websiteUrl?: string;
  duration: string;
  credits?: string;
  faculty: string;
  mission: string;
  projects?: {
    title: string;
    timeline?: string;
    description: string;
    tools?: string[];
    outcomes?: string[];
  }[];
  studentEmployment?: {
    title: string;
    company: string;
    timeline: string;
    description: string;
  }[];
  globalCredentials?: {
    languages: {
      language: string;
      level: string;
      description: string;
    }[];
  };
  analyticalCredentials?: {
    rigor: string;
    modules: string;
    communication: string;
  };
  coreModules?: string[];
  technicalSkills?: string[];
  documents: { title: string; type: string; }[];
}

const {
  modalId,
  degree,
  university,
  location,
  years,
  imageUrl = "https://placehold.co/600x200/0a192f/64ffda?text=University+Campus",
  websiteUrl = "#",
  duration,
  credits,
  faculty,
  mission,
  projects,
  studentEmployment,
  globalCredentials,
  analyticalCredentials,
  coreModules,
  technicalSkills,
  documents
} = Astro.props;
---

<!-- Modal Overlay -->
<div id={modalId} class="hidden fixed inset-0 z-50 items-center justify-center bg-navy/90 backdrop-blur-sm p-4 overflow-y-auto modal-overlay">
  <!-- Modal Container -->
  <div class="relative bg-light-navy rounded-lg shadow-2xl w-full max-w-4xl my-8 modal-content border border-lightest-navy">
    
    <!-- Close Button -->
    <button class="absolute top-4 right-4 z-10 text-slate hover:text-green transition-colors text-2xl font-bold p-2 hover:bg-navy/50 rounded" data-close-modal={modalId}>
      âœ•
    </button>

    <!-- Scrollable Content -->
    <div class="overflow-y-auto max-h-[85vh]">
      
      <!-- Header Image -->
      <a href={websiteUrl} target="_blank" class="block overflow-hidden rounded-t-lg">
        <img 
          src={imageUrl} 
          alt={`${university} Campus`}
          class="w-full h-48 object-cover hover:scale-105 transition-transform duration-300"
        />
      </a>

      <!-- Content Padding -->
      <div class="p-8">
        
        <!-- Title Section -->
        <h3 class="text-3xl font-bold text-lightest-slate mb-2">
          {degree}
        </h3>
        <p class="text-slate text-lg mb-6">
          {university} | {location} | {years}
        </p>

        <!-- Quick Stats Bar -->
        <div class={`grid ${credits ? 'sm:grid-cols-3' : 'sm:grid-cols-2'} gap-4 mb-8 p-4 bg-navy/50 rounded-lg border border-lightest-navy`}>
          <div class="text-center">
            <p class="text-green font-mono text-sm mb-1">Duration</p>
            <p class="text-lightest-slate font-semibold">{duration}</p>
          </div>
          {credits && (
            <div class="text-center">
              <p class="text-green font-mono text-sm mb-1">Credits</p>
              <p class="text-lightest-slate font-semibold">{credits}</p>
            </div>
          )}
          <div class="text-center">
            <p class="text-green font-mono text-sm mb-1">Primary Faculty</p>
            <p class="text-lightest-slate font-semibold">{faculty}</p>
          </div>
        </div>

        <!-- Mission Narrative -->
        <div class="mb-8">
          <h4 class="text-xl font-bold text-lightest-slate mb-3 flex items-center gap-2">
            <span class="text-green">â–¹</span> Core Focus
          </h4>
          <p class="text-slate leading-relaxed">
            {mission}
          </p>
        </div>

        <!-- Academic Projects Section (Optional) -->
        {projects && projects.length > 0 && (
          <div class="mb-8">
            <h4 class="text-xl font-bold text-lightest-slate mb-4 flex items-center gap-2">
              <span class="text-green">â–¹</span> Academic Projects
            </h4>
            
            <div class="space-y-6">
              {projects.map(project => (
                <div class="p-5 bg-navy/30 rounded-lg border border-lightest-navy">
                  <h5 class="text-lg font-semibold text-lightest-slate mb-1">
                    {project.title}
                  </h5>
                  {project.timeline && (
                    <p class="text-green text-xs font-mono mb-3">
                      {project.timeline}
                    </p>
                  )}
                  <p class="text-slate leading-relaxed mb-4">
                    {project.description}
                  </p>
                  
                  {project.tools && project.tools.length > 0 && (
                    <div class="mb-3">
                      <p class="text-green font-mono text-xs mb-2 uppercase tracking-wide">Tools & Technologies</p>
                      <div class="flex flex-wrap gap-2">
                        {project.tools.map(tool => (
                          <span class="text-xs px-2 py-1 bg-green/10 text-green border border-green/30 rounded">
                            {tool}
                          </span>
                        ))}
                      </div>
                    </div>
                  )}
                  
                  {project.outcomes && project.outcomes.length > 0 && (
                    <div>
                      <p class="text-green font-mono text-xs mb-2 uppercase tracking-wide">Key Outcomes</p>
                      <ul class="space-y-1">
                        {project.outcomes.map(outcome => (
                          <li class="flex gap-2 text-slate text-sm">
                            <span class="text-green mt-0.5">â–¹</span>
                            <span>{outcome}</span>
                          </li>
                        ))}
                      </ul>
                    </div>
                  )}
                </div>
              ))}
            </div>
          </div>
        )}

        <!-- Analytical Credentials (Optional) -->
        {analyticalCredentials && (
          <div class="mb-8">
            <h4 class="text-xl font-bold text-lightest-slate mb-4 flex items-center gap-2">
              <span class="text-green">â–¹</span> Comprehensive Analytical Credentials
            </h4>
            
            <div class="space-y-3 text-slate">
              <p class="leading-relaxed">
                <span class="text-lightest-slate font-semibold">Analytical Rigor: </span>
                {analyticalCredentials.rigor}
              </p>
              <p class="leading-relaxed">
                <span class="text-lightest-slate font-semibold">Core Academic Modules: </span>
                {analyticalCredentials.modules}
              </p>
              <p class="leading-relaxed">
                <span class="text-lightest-slate font-semibold">Global Communication: </span>
                {analyticalCredentials.communication}
              </p>
            </div>
          </div>
        )}

        <!-- Student Employment & Integration (Optional) -->
        {studentEmployment && studentEmployment.length > 0 && (
          <div class="mb-8">
            <h4 class="text-xl font-bold text-lightest-slate mb-4 flex items-center gap-2">
              <span class="text-green">â–¹</span> Student Employment & Integration
            </h4>
            
            <div class="space-y-4">
              {studentEmployment.map(job => (
                <div class="p-4 bg-navy/30 rounded-lg border border-lightest-navy">
                  <div class="flex justify-between items-start mb-2">
                    <h5 class="text-lg font-semibold text-lightest-slate">
                      {job.title}
                    </h5>
                  </div>
                  <p class="text-green text-sm font-mono mb-2">
                    {job.company} | {job.timeline}
                  </p>
                  <p class="text-slate text-sm leading-relaxed">
                    {job.description}
                  </p>
                </div>
              ))}
            </div>
          </div>
        )}

        <!-- Global Credentials (Optional) -->
        {globalCredentials && globalCredentials.languages && (
          <div class="mb-8">
            <h4 class="text-xl font-bold text-lightest-slate mb-4 flex items-center gap-2">
              <span class="text-green">â–¹</span> Global Credentials
            </h4>
            
            <div class="grid md:grid-cols-2 gap-4">
              {globalCredentials.languages.map(lang => (
                <div class="p-4 bg-navy/50 rounded-lg border border-lightest-navy">
                  <h5 class="text-green font-mono text-sm mb-1 uppercase tracking-wide">
                    {lang.language}
                  </h5>
                  <p class="text-lightest-slate font-semibold mb-2">
                    {lang.level}
                  </p>
                  <p class="text-slate text-sm">
                    {lang.description}
                  </p>
                </div>
              ))}
            </div>
          </div>
        )}

        <!-- The Toolkit (Two-Column) - Optional -->
        {(coreModules || technicalSkills) && (
          <div class="mb-8">
            <h4 class="text-xl font-bold text-lightest-slate mb-4 flex items-center gap-2">
              <span class="text-green">â–¹</span> The Toolkit
            </h4>
            
            <div class="grid md:grid-cols-2 gap-6">
              {coreModules && (
                <div>
                  <h5 class="text-green font-mono text-sm mb-3 uppercase tracking-wide">Core Modules</h5>
                  <ul class="space-y-2">
                    {coreModules.map(module => (
                      <li class="flex items-start gap-2 text-slate">
                        <span class="text-green mt-1">â–¹</span>
                        <span>{module}</span>
                      </li>
                    ))}
                  </ul>
                </div>
              )}

              {technicalSkills && (
                <div>
                  <h5 class="text-green font-mono text-sm mb-3 uppercase tracking-wide">Technical Skills</h5>
                  <ul class="space-y-2">
                    {technicalSkills.map(skill => (
                      <li class="flex items-start gap-2 text-slate">
                        <span class="text-green mt-1">â–¹</span>
                        <span>{skill}</span>
                      </li>
                    ))}
                  </ul>
                </div>
              )}
            </div>
          </div>
        )}

        <!-- Credentials Gallery -->
        <div class="mb-8">
          <h4 class="text-xl font-bold text-lightest-slate mb-4 flex items-center gap-2">
            <span class="text-green">â–¹</span> Verified Credentials & Certificates
          </h4>
          
          <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {documents.map(doc => (
              <a 
                href="#" 
                class="group bg-navy/50 p-4 rounded-lg border border-lightest-navy hover:border-green transition-all duration-300"
              >
                <div class="flex items-center justify-center h-24 mb-3 bg-lightest-navy/30 rounded group-hover:scale-105 transition-transform duration-300">
                  <span class="text-green text-4xl">ðŸ“„</span>
                </div>
                <p class="text-lightest-slate text-sm font-semibold mb-1 group-hover:text-green transition-colors">
                  {doc.title}
                </p>
                <p class="text-slate text-xs font-mono">{doc.type}</p>
              </a>
            ))}
          </div>
        </div>

        <!-- Download CV Button -->
        <div class="text-center">
          <a 
            href="/Vashisth_Patel_CV.pdf" 
            target="_blank"
            class="inline-flex items-center gap-2 px-8 py-4 border-2 border-green text-green font-mono text-base rounded hover:bg-green/10 transition-all duration-300 hover:scale-105"
          >
            <span>ðŸ“¥</span>
            Download Full CV
          </a>
        </div>

      </div>
    </div>
  </div>
</div>

<style>
  .modal-overlay {
    animation: fadeIn 0.3s ease-out;
  }
  
  .modal-content {
    animation: scaleIn 0.3s ease-out;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  
  @keyframes scaleIn {
    from {
      transform: scale(0.95);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const closeButtons = document.querySelectorAll('[data-close-modal]');
    closeButtons.forEach(button => {
      button.addEventListener('click', () => {
        const modalId = button.getAttribute('data-close-modal');
        const modal = document.getElementById(modalId);
        if (modal) {
          modal.classList.add('hidden');
          modal.classList.remove('flex');
          document.body.style.overflow = '';
        }
      });
    });

    const modals = document.querySelectorAll('.modal-overlay');
    modals.forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.add('hidden');
          modal.classList.remove('flex');
          document.body.style.overflow = '';
        }
      });
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        const openModal = document.querySelector('.modal-overlay.flex');
        if (openModal) {
          openModal.classList.add('hidden');
          openModal.classList.remove('flex');
          document.body.style.overflow = '';
        }
      }
    });
  });
</script>
